<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>새로운 보고서 작성</title>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const noIssueCheckbox = document.querySelector('input[name="no_issue"]');
            const otherCheckboxes = document.querySelectorAll('input[name="eye"], input[name="teeth"], input[name="skin"], input[name="back"], input[name="other"]');

            function toggleCheckboxes() {
                if (noIssueCheckbox.checked) {
                    otherCheckboxes.forEach(checkbox => checkbox.disabled = true);
                } else {
                    otherCheckboxes.forEach(checkbox => checkbox.disabled = false);
                }

                if (Array.from(otherCheckboxes).some(checkbox => checkbox.checked)) {
                    noIssueCheckbox.disabled = true;
                } else {
                    noIssueCheckbox.disabled = false;
                }
            }

            noIssueCheckbox.addEventListener('change', toggleCheckboxes);
            otherCheckboxes.forEach(checkbox => checkbox.addEventListener('change', toggleCheckboxes));

            // Initialize state on page load
            toggleCheckboxes();

            document.getElementById('other').addEventListener('change', function() {
                var otherText = document.getElementById('other_text');
                if (this.checked) {
                    otherText.style.display = 'block';
                } else {
                    otherText.style.display = 'none';
                }
            });
        });
    </script>
</head>
<body>
    <h1>새로운 보고서 작성</h1>
    <form method="post" enctype="multipart/form-data">
        {% csrf_token %}
        <label>이상 부위:</label><br>
        <input type="checkbox" name="no_issue"> 특이사항 없음<br>
        <input type="checkbox" name="eye"> 눈<br>
        <input type="checkbox" name="teeth"> 치아<br>
        <input type="checkbox" name="skin"> 피부<br>
        <input type="checkbox" name="back"> 허리<br>
        <input type="checkbox" name="other" id="other-checkbox"> 기타<br>
        <input type="text" name="other_text" id="other-text" style="display:none;"><br>

        <label>이미지 업로드:</label><br>
        <input type="file" name="images" multiple><br>

        <label>음성 Test:</label><br>
        <input type="file" name="audio_file"><br>

        {%if care.care_type == '병원'%}
            <br><label>의사 소견</label><br>
            <textarea name="doctor_opinion"></textarea><br>
        {% endif %}

        <br><label>전달 사항</label><br>
        <textarea name="user_request"></textarea><br>

        <button type="submit">보고서 작성하기</button>
        <button type="button" onclick="window.location.href = '/management/report/list/'" class="cancle">취소</button>
    </form>

    {% comment %} <script>
        // '기타' 체크박스 선택 시, 텍스트 입력 필드 표시
        document.getElementById('other-checkbox').addEventListener('change', function() {
            document.getElementById('other-text').style.display = this.checked ? 'block' : 'none';
        });
    </script> {% endcomment %}
</body>
</html>
